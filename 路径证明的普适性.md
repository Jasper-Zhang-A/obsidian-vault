# Case Study: Partial Derivatives & Their Continuity (2021 Exam, Q1)

> [!question] Problem Statement
> Given the function:
> $$ f(x,y)=\begin{cases} (x^{2}+y^{2})\sin\frac{1}{x^{2}+y^{2}}, & x^{2}+y^{2}\ne0 \\ 0, & x^{2}+y^{2}=0 \end{cases} $$
> (a) Calculate the partial derivatives $f_x(x,y)$ and $f_y(x,y)$.
> (b) Is the function $f_x(x,y)$ continuous at (0,0)? Give your reasons in detail.

---

## Part (a): Calculating Partial Derivatives (计算偏导数)

计算这类分段函数的偏导数，必须分两种情况讨论。

### Case 1: When $(x,y) \ne (0,0)$

此时，我们直接对函数表达式使用**乘积法则 (Product Rule)** 和 **链式法则 (Chain Rule)**。

$$ \frac{\partial f}{\partial x} = \frac{\partial}{\partial x} \left[ (x^2+y^2) \cdot \sin\left(\frac{1}{x^2+y^2}\right) \right] $$
$$ = \left(\frac{\partial}{\partial x}(x^2+y^2)\right) \cdot \sin\left(\frac{1}{x^2+y^2}\right) + (x^2+y^2) \cdot \left(\frac{\partial}{\partial x}\sin\left(\frac{1}{x^2+y^2}\right)\right) $$
$$ = (2x) \cdot \sin\left(\frac{1}{x^2+y^2}\right) + (x^2+y^2) \cdot \cos\left(\frac{1}{x^2+y^2}\right) \cdot \left(\frac{-2x}{(x^2+y^2)^2}\right) $$
$$ = 2x\sin\left(\frac{1}{x^2+y^2}\right) - \frac{2x}{x^2+y^2}\cos\left(\frac{1}{x^2+y^2}\right) $$
由于对称性，$f_y(x,y)$ 的计算类似，只需将 $x$ 换成 $y$：
$$ f_y(x,y) = 2y\sin\left(\frac{1}{x^2+y^2}\right) - \frac{2y}{x^2+y^2}\cos\left(\frac{1}{x^2+y^2}\right) $$

### Case 2: When $(x,y) = (0,0)$

> [!warning] Common Pitfall / 我的错误分析 (Part a)
> 我在做第一问的时候，可能只计算了上面那个复杂的表达式，然后忘记了在 $(0,0)$ 这一点，偏导数**必须**使用极限的定义来求，不能直接代入。这是一个关键的失分点。

**计算 $f_x(0,0)$:**
$$ f_x(0,0) = \lim_{h \to 0} \frac{f(h, 0) - f(0,0)}{h} $$
其中 $f(0,0)=0$，且 $f(h,0) = (h^2+0^2)\sin(\frac{1}{h^2+0^2}) = h^2\sin(\frac{1}{h^2})$。
$$ f_x(0,0) = \lim_{h \to 0} \frac{h^2\sin(\frac{1}{h^2})}{h} = \lim_{h \to 0} h\sin\left(\frac{1}{h^2}\right) $$
由于 $-1 \le \sin(\frac{1}{h^2}) \le 1$，所以 $-|h| \le h\sin(\frac{1}{h^2}) \le |h|$。根据**夹逼准则 (Squeeze Theorem)**，当 $h \to 0$ 时，该极限为 $0$。
所以，$f_x(0,0) = 0$。同理可得，$f_y(0,0) = 0$。

---

## Part (b): Continuity of the Partial Derivative $f_x(x,y)$ (偏导函数的连续性)

要判断 $f_x(x,y)$ 在 $(0,0)$ 是否连续，我们需要检验：
$$ \lim_{(x,y)\to(0,0)} f_x(x,y) \stackrel{?}{=} f_x(0,0) $$
我们已经知道 $f_x(0,0)=0$。现在我们需要计算左边的极限。

> [!warning] Common Pitfall / 我的错误分析 (Part b)
> 我想当然地认为可以直接把 $(0,0)$ 代入到 $f_x(x,y)$ 的表达式中来判断极限。我当时的分析可能是：
> $$ \lim_{(x,y)\to(0,0)} \left( \underbrace{2x\sin\left(\frac{1}{x^2+y^2}\right)}_{\text{第一项}} - \underbrace{\frac{2x}{x^2+y^2}\cos\left(\frac{1}{x^2+y^2}\right)}_{\text{第二项}} \right) $$
> 我觉得第一项因为有 $2x$ 因子，所以极限是 $0$。第二项因为分母趋近于0，所以极限是无穷。
> **错误原因 (Root Cause):**
> 这个想法是错误的。当一个表达式中包含像 $\cos(\frac{1}{u})$ 或 $\sin(\frac{1}{u})$ 这样在 $u \to 0$ 时会**无限振荡**的项时，我们**不能**想当然地进行代入或拆分极限。它的极限可能不存在，必须使用**路径法**来检验。

### Correct Method: Path Test (正确方法：路径法)

我们来计算 $f_x(x,y)$ 在趋近 $(0,0)$ 时的极限。
$$ \lim_{(x,y)\to(0,0)} \left( 2x\sin\left(\frac{1}{x^2+y^2}\right) - \frac{2x}{x^2+y^2}\cos\left(\frac{1}{x^2+y^2}\right) \right) $$
* **第一部分**: 对于 $2x\sin(\frac{1}{x^2+y^2})$，因为 $\sin$ 函数有界，而 $2x \to 0$，所以根据夹逼准则，这部分的极限是 $0$。
* **第二部分**: 我们来检验 $\lim_{(x,y)\to(0,0)} \frac{2x}{x^2+y^2}\cos(\frac{1}{x^2+y^2})$。
    * **路径一：沿 y 轴 ($x=0$)**
        $$ \lim_{(0,y)\to(0,0)} \frac{2(0)}{0^2+y^2}\cos\left(\frac{1}{0^2+y^2}\right) = \lim_{y\to 0} 0 = 0 $$
    * **路径二：沿 x 轴 ($y=0$)**
        $$ \lim_{(x,0)\to(0,0)} \frac{2x}{x^2+0^2}\cos\left(\frac{1}{x^2+0^2}\right) = \lim_{x\to 0} \frac{2}{x}\cos\left(\frac{1}{x^2}\right) $$
        当 $x \to 0$ 时，$\frac{2}{x}$ 趋于无穷，而 $\cos(\frac{1}{x^2})$ 在 $-1$ 和 $1$ 之间无限振荡。这个极限显然**不存在**。

### Final Conclusion (最终结论)
因为 $f_x(x,y)$ 的第二部分在趋近原点时的极限不存在，所以整个 $f_x(x,y)$ 的极限也不存在。
既然极限 $\lim_{(x,y)\to(0,0)} f_x(x,y)$ 不存在，它自然不可能等于 $f_x(0,0)=0$。
因此，函数 $f_x(x,y)$ 在点 $(0,0)$ **不连续**。