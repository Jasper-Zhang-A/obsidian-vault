# Case Study: The Chain Rule (Assignment-6, Q1)

> [!question] Problem Statement
> Given:
> $$w=\ln(x^{2}+y^{2}+z^{2})$$
> $$x=ue^{v}\sin u, \quad y=ue^{v}\cos u, \quad z=ue^{v}$$
> Express `∂w/∂u` and `∂w/∂v` as functions of `u` and `v`, using both the Chain Rule and by direct substitution. 
> Evaluate `∂w/∂u` and `∂w/∂v` at the point `(u,v)=(-2,0)`. 

---

> [!warning] Common Pitfall / 常见陷阱：Incomplete Substitution
> 
> **我的错误经历分析：**
> 我第一次做这道题时，虽然正确地写出了链式法则的公式，也计算了各个偏导数，例如：
> $$\frac{\partial w}{\partial u} = \frac{\partial w}{\partial x}\frac{\partial x}{\partial u} + \frac{\partial w}{\partial y}\frac{\partial y}{\partial u} + \frac{\partial w}{\partial z}\frac{\partial z}{\partial u}$$
> 但是，在代入后，我的答案停留在了类似这样的形式：
> $$\frac{\partial w}{\partial u} = \left( \frac{2x}{x^2+y^2+z^2} \right) (e^v\sin u + ue^v\cos u) + \dots$$
> **错误原因：** 这个表达式虽然数学上没有错，但它**没有完成题目要求**。最终答案必须是**只关于 `u` 和 `v` 的函数**，而我的答案里还混杂着 `x`, `y`, `z`。正确的做法是在最后一步，将所有的 `x`, `y`, `z` 也用 `u` 和 `v` 的表达式替换掉，并化至最简。

---

## Correct Solution Walkthrough / 正确解法步骤

### Part (a): Finding the Partial Derivatives

#### Method 1: The Chain Rule (The "Long" Way)

**Step 1: Write down the Chain Rule formulas.**
$$ \frac{\partial w}{\partial u} = \frac{\partial w}{\partial x}\frac{\partial x}{\partial u} + \frac{\partial w}{\partial y}\frac{\partial y}{\partial u} + \frac{\partial w}{\partial z}\frac{\partial z}{\partial u} $$
$$ \frac{\partial w}{\partial v} = \frac{\partial w}{\partial x}\frac{\partial x}{\partial v} + \frac{\partial w}{\partial y}\frac{\partial y}{\partial v} + \frac{\partial w}{\partial z}\frac{\partial z}{\partial v} $$

**Step 2: Calculate all necessary partial derivatives.**
$$ \frac{\partial w}{\partial x} = \frac{2x}{x^2+y^2+z^2} \quad \frac{\partial w}{\partial y} = \frac{2y}{x^2+y^2+z^2} \quad \frac{\partial w}{\partial z} = \frac{2z}{x^2+y^2+z^2} $$
$$ \frac{\partial x}{\partial u} = e^v\sin u + ue^v\cos u \quad \frac{\partial y}{\partial u} = e^v\cos u - ue^v\sin u \quad \frac{\partial z}{\partial u} = e^v $$
$$ \frac{\partial x}{\partial v} = ue^v\sin u \quad \frac{\partial y}{\partial v} = ue^v\cos u \quad \frac{\partial z}{\partial v} = ue^v $$

**Step 3: Substitute and simplify completely.**
First, let's simplify the common denominator by expressing it in terms of `u` and `v`:
$$ x^2+y^2+z^2 = (ue^v\sin u)^2 + (ue^v\cos u)^2 + (ue^v)^2 $$
$$ = u^2e^{2v}(\sin^2 u + \cos^2 u) + u^2e^{2v} = u^2e^{2v} + u^2e^{2v} = 2u^2e^{2v} $$
Now, let's calculate `∂w/∂u`:
$$ \frac{\partial w}{\partial u} = \left(\frac{2x}{2u^2e^{2v}}\right)\frac{\partial x}{\partial u} + \left(\frac{2y}{2u^2e^{2v}}\right)\frac{\partial y}{\partial u} + \left(\frac{2z}{2u^2e^{2v}}\right)\frac{\partial z}{\partial u} $$
Substitute $x, y, z$ and their derivatives, then cancel out terms (as shown in the previous detailed answer). The simplified result is:
$$ \frac{\partial w}{\partial u} = \frac{2}{u} $$
And for `∂w/∂v`:
$$ \frac{\partial w}{\partial v} = \left(\frac{2x}{x^2+y^2+z^2}\right)x + \left(\frac{2y}{x^2+y^2+z^2}\right)y + \left(\frac{2z}{x^2+y^2+z^2}\right)z $$
$$ = \frac{2(x^2+y^2+z^2)}{x^2+y^2+z^2} = 2 $$

#### Method 2: Direct Substitution (The "Smart" Way)

**Step 1: Express `w` in terms of `u` and `v` directly.**
From our calculation above, we know $x^2+y^2+z^2 = 2u^2e^{2v}$.
$$ w = \ln(2u^2e^{2v}) $$
Using logarithm properties to simplify:
$$ w = \ln(2) + \ln(u^2) + \ln(e^{2v}) = \ln(2) + 2\ln|u| + 2v $$

**Step 2: Differentiate the simplified function.**
$$ \frac{\partial w}{\partial u} = \frac{\partial}{\partial u}(\ln(2) + 2\ln|u| + 2v) = \frac{2}{u} $$
$$ \frac{\partial w}{\partial v} = \frac{\partial}{\partial v}(\ln(2) + 2\ln|u| + 2v) = 2 $$
This method is much faster and less prone to algebraic errors.

### Part (b): Evaluation at Point `(-2, 0)`

[cite_start]Substitute `u = -2` and `v = 0` into our final results from Part (a). 

* **For `∂w/∂u`**:
    $$ \frac{\partial w}{\partial u}\bigg|_{(-2,0)} = \frac{2}{-2} = -1 $$

* **For `∂w/∂v`**:
    $$ \frac{\partial w}{\partial v}\bigg|_{(-2,0)} = 2 $$